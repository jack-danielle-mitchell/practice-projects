<!DOCTYPE html>
<html lang="en">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Subscribe Form to Google Sheets Tutorial</title>
        <link rel="stylesheet" href="style.css">
    </head>
    <body>
        <div class="hero">
            <h3>Coming Soon!</h3>
            <h1>Our Brand New<br>Website Is On Its Way</h1>
            <p>Subscribe for more details:</p>
            <form name="submit-to-google-sheet">
                <input type="email" name="Email" placeholder="Your email address">
                <button type="submit"><img src="images/send-icon.png" width="30px"></button>
            </form>
            <span id="msg"></span>
        </div>
        <script>
        const scriptURL = 'https://script.google.com/macros/s/AKfycbx33k2Xg8ooRYur4Aj-YxeQD6uk-BQs46YAVik0SgEQgOI6sE7bShCZokp9BSNZD8hhCA/exec'
        const form = document.forms['submit-to-google-sheet']
        const msg = document.getElementById("msg");

        form.addEventListener('submit', e => {
            e.preventDefault()
            fetch(scriptURL, { method: 'POST', body: new FormData(form)})
            .then(response => {
                msg.innerHTML="Thank You For Subscribing!"
                setTimeout(() => {
                    msg.innerHTML=""
                }, 5000);
                form.reset();
            })
            .catch(error => console.error('Error!', error.message))
        })
        </script>
    </body>
</html>